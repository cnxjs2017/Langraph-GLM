# Langraph-GLM

- Langragh using GLM-4-flash, with 2 LLMs and 1 tool
- 本项目旨在为初次接触多智能体开发的同学提供一点学习资料，并给出了一个使用Langraph搭建多智能体的demo，这个demo使用了两个智能体和一个工具。
- 代码比较粗糙，仅供参考，欢迎大家指正。

## 理论部分

### 智能体与多智能体

- 智能体与普通的大语言模型的区别在于“智能”；
- 我们通过它的自主性来彰显智能体的“智能”；
- 它的自主性体现在可以选择下一步的行为，调用工具、与其他的智能体交流抑或是结束对话，都取决于智能体自己；
- 那么多智能体指的就是多个智能体和多个工具的组合。

### 多智能体的抽象与建模

- 用编程思维去看多智能体的实现，我们需要进行抽象与建模；
- 注意到，多智能体的架构与图数据结构很相似，那么我们可以抽象出节点和边两个基本元素；
- 节点代表智能体或者工具，边代表它们之间的交互，即调用顺序；
- 值得注意的是，边有普通的边和可选的边，我们通过可选的边来体现“智能”。

### 多智能体的伪代码构思

1. 单-“多智能体”
    - 正如圆被认为是一种特殊的椭圆，单个大预言模型也可以被认为是一种特殊的智能体，而单个智能体也是一种特殊的“多”智能体；
    - 因此，单个大语言模型可以是最简单的多智能体，我们有输入->智能体1->输出的图结构。
2. 调用工具的单-“多智能体”
    - 我们知道，大语言模型的训练时间长，不会有最新的数据纳入训练，因而问及今天天气等信息，就无法正确作答，此时就需要调用工具。
    - 显然，可以得到输入->智能体1->工具->智能体1->输出的顺序；
    - 同时，并非所有时候都需要调用工具，因此智能体1->工具的边是可选边，而工具->智能体的边是普通边。
    - 如果不需要调用工具，智能体1可以直接输出结果。
3. 真正的多智能体
    - 多智能体的实现可以更复杂，比如有多个智能体，每个智能体都有自己的输入、输出、工具等，因此需要更复杂的图结构；
    - 举个例子，在2的基础上，还可以把输出的结果交给一个用于美化文本的智能体，此时可以得到输入->智能体1->工具->智能体1->
      智能体2->输出的顺序。
    - 多智能体的基本组件已经讲解完成，接下来就可以自由发挥了。

- 值得注意的是，不同的框架对实现上述思路有不同的方法，但大体思路是一直的，成熟的框架也会封装好多个智能体的实现，下面我们用Langraph做简单的智能体。

## 实践部分

### 依赖下载

首先最好为这个项目新建一个环境，如果你使用的是conda，那么：

```shell
conda create -n langraph python=3.10  # 建立一个环境，名为langraph，python版本为3.10
conda activate langraph  # 激活这个环境
```

接着下载langraph的依赖

```shell
pip install -r requirements.txt
```

### 获取api_key

这个项目使用了免费的glm-4-flash作为智能体的本体，需要在指定位置填自己的api_key才可以运行，搜索智谱api_key应该会有很多获取api_key的教程，本处不再赘述。

### 学习顺序

1. llm1，这个文件实现了单-“多智能体”，tool实现了工具调用；
2. llm1_tool1，这个文件实现了调用工具的单-“多智能体”；
3. llm2，这个文件实现了真正的多智能体；
4. 基于llm2，我拆分出agents、config、tools、workflow、main五个文件，算是一种小型的代码实践。
- 建议一个一个运行过来看懂逻辑。
